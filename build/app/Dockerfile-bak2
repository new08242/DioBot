FROM golang:1.11.5-alpine3.8

RUN apk update; \
  apk add --no-cache \
      ca-certificates \
      curl \
      git \
      make \
      openssl; \
  curl -L -s https://github.com/golang/dep/releases/download/v${DEP_VERSION}/dep-linux-amd64 -o /bin/dep; \
  chmod +x /bin/dep; \
  rm -rf /var/cache/apk/*; \
  rm -rf /tmp/*

ENV APP_PATH /go/src/dio-bot
WORKDIR ${APP_PATH}

RUN mkdir app
RUN cd ./app
COPY . .

RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build

RUN ls -lrth ./app

EXPOSE 9999

ENTRYPOINT ["./app/dio-bot"]
